<html data-reactroot=""><head><meta charset="utf-8"/><meta name="theme-color" content="#2B3A42"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Writing a Plugin | webpack</title><meta name="description" content="webpack is a module bundler. Its main purpose is to bundle JavaScript files for usage in a browser, yet it is also capable of transforming, bundling, or packaging just about any resource or asset."/><meta property="og:site_name" content="webpack"/><meta property="og:type" content="website"/><meta property="og:title" content="Writing a Plugin | webpack"/><meta property="og:description" name="description" content="webpack is a module bundler. Its main purpose is to bundle JavaScript files for usage in a browser, yet it is also capable of transforming, bundling, or packaging just about any resource or asset."/><meta property="og:image" content="/aad9d51e01a0dcc2caf5bee43dc8e647.svg"/><meta property="twitter:card" content="summary"/><meta property="twitter:site" content="@webpack"/><meta property="twitter:creator" content="@webpack"/><meta property="twitter:domain" content="https://webpack.js.org/"/><link rel="icon" type="image/x-icon" href="/bc3effb418df77da9e04825c48a58a49.ico"/><link rel="stylesheet" href="/3b710dea0214f61ad402.css"/></head><body><div id="root"><div class="site"><div class="notification-bar"><div class="container notification-bar__inner"><p>Sponsor webpack and get apparel from the <a href="https://webpack.threadless.com">official shop</a>! All proceeds go to our <a href="https://opencollective.com/webpack">open collective</a>!</p></div></div><header class="navigation   "><section class="navigation__inner"><button class="navigation__mobile"><svg viewBox="-62 138 25 25"><g><g><path d="M-60.2,140.2h20.9c1,0,1.8,0.8,1.8,1.8l0,0c0,1-0.8,1.8-1.8,1.8h-20.9c-1,0-1.8-0.8-1.8-1.8l0,0 C-62,141-61.2,140.2-60.2,140.2z"></path><path d="M-60.2,148.7h20.9c1,0,1.8,0.8,1.8,1.8l0,0c0,1-0.8,1.8-1.8,1.8h-20.9c-1,0-1.8-0.8-1.8-1.8l0,0 C-62,149.5-61.2,148.7-60.2,148.7z"></path><path d="M-60.2,157.2h20.9c1,0,1.8,0.8,1.8,1.8l0,0c0,1-0.8,1.8-1.8,1.8h-20.9c-1,0-1.8-0.8-1.8-1.8l0,0 C-62,158-61.2,157.2-60.2,157.2z"></path></g></g></svg></button><a class="navigation__logo" href="/"><img class="logo" src="/e0b5805d423a4ec9473ee315250968b2.svg" alt="webpack logo"/></a><nav class="navigation__items"><a class="navigation__item   " href="/concepts">Documentation</a><a class="navigation__item navigation__item--active  " href="/contribute">Contribute</a><a class="navigation__item   " href="/vote">Vote</a><a href="https://medium.com/webpack" target="_blank" rel="noopener" class="navigation__item   ">Blog</a><a href="https://github.com/webpack/webpack" target="_blank" rel="noopener" title="GitHub Repository" class="navigation__item   navigation__item--icon"><i aria-hidden="true" class="icon-github"></i></a><a href="https://stackoverflow.com/questions/tagged/webpack" target="_blank" rel="noopener" title="Webpack on Stack Overflow" class="navigation__item   navigation__item--icon"><i aria-hidden="true" class="icon-stack-overflow"></i></a><span class="navigation__item   navigation__item--icon"><nav class="dropdown navigation__languages"><button aria-haspopup="true" aria-expanded="false" aria-label="Select language"><img class="dropdown__language" alt="select language" src="/57c717e75066b659cfe19dc2a643153c.svg"/><i aria-hidden="true" class="dropdown__arrow"></i></button><div class="dropdown__list "><ul><li><a href="https://webpack.js.org/"><span>English</span></a></li><li><a href="https://webpack.docschina.org/"><span lang="zh">中文</span></a></li></ul></div></nav></span></nav><div class="navigation-search "><input type="text" class="navigation-search__input" placeholder="Search this site..." value=""/><button class="navigation-search__icon navigation-search__clear"><svg viewBox="-137 138 25 25"><g transform="translate(0,-952.36218)"><path d="M-131.3,1094.4c-0.4,0-0.9,0.1-1.2,0.5c-0.7,0.7-0.7,1.7,0,2.4l5.6,5.6l-5.6,5.6c-0.7,0.7-0.7,1.7,0,2.4 c0.7,0.7,1.7,0.7,2.4,0l5.6-5.6l5.6,5.6c0.7,0.7,1.7,0.7,2.4,0c0.7-0.7,0.7-1.7,0-2.4l-5.6-5.6l5.6-5.6c0.7-0.7,0.7-1.7,0-2.4 c-0.7-0.7-1.7-0.7-2.4,0l-5.6,5.6l-5.6-5.6C-130.5,1094.5-130.9,1094.4-131.3,1094.4L-131.3,1094.4z"></path></g></svg></button><button class="navigation-search__icon navigation-search__search"><svg viewBox="-137 138 25 25"><g><path d="M-114.6,162.6l-7.5-7.5c-0.6-0.6-0.6-1.6,0-2.1l0,0c0.6-0.6,1.6-0.6,2.1,0l7.5,7.5c0.6,0.6,0.6,1.6,0,2.1l0,0 C-113,163.1-114,163.1-114.6,162.6z"></path><path d="M-134.1,140.9c-3.9,3.9-3.9,10.2,0,14.1s10.2,3.9,14.1,0s3.9-10.2,0-14.1S-130.2,137-134.1,140.9z M-122.1,153 c-2.7,2.7-7.1,2.7-9.8,0s-2.7-7.1,0-9.8s7.1-2.7,9.8,0C-119.4,145.9-119.4,150.2-122.1,153z"></path></g></svg></button></div></section><div class="navigation-sub"><div class="navigation-sub__inner"></div></div></header><div class="container site__content"><div class="sponsors"><a href="https://www.ag-grid.com/?utm_source=webpack&amp;utm_medium=banner&amp;utm_campaign=sponsorship" target="_blank" rel="noopener" class="sponsors__content"><img src="/bf176a25b4f8227fea804854c98dc5e2.png"/><img src="/d19378a95ebe6b15d5ddea281138dcf4.svg" style="width:100px"/><div style="margin-top:1em;font-size:2em;text-align:center;color:#535353">ag-grid is proud to partner with webpack</div></a></div><nav class="sidebar site__sidebar"><div class="sidebar__inner"><a href="https://github.com/webpack/webpack/releases"><img alt="webpack shield" src="https://img.shields.io/npm/v/webpack.svg?label=webpack&amp;style=flat-square&amp;maxAge=3600"/></a><div class="sidebar-item  "><i class="sidebar-item__toggle icon-chevron-right"></i><a class="sidebar-item__title" href="/contribute">Contribute</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Developers"><a href="/contribute#developers">Developers</a></li><li class="sidebar-item__anchor" title="How Can I Help?"><a href="/contribute#how-can-i-help">How Can I Help?</a></li><li class="sidebar-item__anchor" title="Encouraging Employers"><a href="/contribute#encouraging-employers">Encouraging Employers</a></li><li class="sidebar-item__anchor" title="Your Contributions"><a href="/contribute#your-contributions">Your Contributions</a></li><li class="sidebar-item__anchor" title="Executives"><a href="/contribute#executives">Executives</a></li><li class="sidebar-item__anchor" title="Sponsorship"><a href="/contribute#sponsorship">Sponsorship</a></li><li class="sidebar-item__anchor" title="Anyone Else"><a href="/contribute#anyone-else">Anyone Else</a></li></ul></div><div class="sidebar-item  "><i class="sidebar-item__toggle icon-chevron-right"></i><a class="sidebar-item__title" href="/contribute/writers-guide">Writer&#x27;s Guide</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="sort: 2"><a href="/contribute/writers-guide#sort-2">sort: 2</a></li><li class="sidebar-item__anchor" title="Process"><a href="/contribute/writers-guide#process">Process</a></li><li class="sidebar-item__anchor" title="YAML Frontmatter"><a href="/contribute/writers-guide#yaml-frontmatter">YAML Frontmatter</a></li><li class="sidebar-item__anchor" title="Article Structure"><a href="/contribute/writers-guide#article-structure">Article Structure</a></li><li class="sidebar-item__anchor" title="Typesetting"><a href="/contribute/writers-guide#typesetting">Typesetting</a></li><li class="sidebar-item__anchor" title="Formatting"><a href="/contribute/writers-guide#formatting">Formatting</a></li><li class="sidebar-item__anchor" title="Code"><a href="/contribute/writers-guide#code">Code</a></li><li class="sidebar-item__anchor" title="Lists"><a href="/contribute/writers-guide#lists">Lists</a></li><li class="sidebar-item__anchor" title="Tables"><a href="/contribute/writers-guide#tables">Tables</a></li><li class="sidebar-item__anchor" title="Configuration Properties"><a href="/contribute/writers-guide#configuration-properties">Configuration Properties</a></li><li class="sidebar-item__anchor" title="Quotes"><a href="/contribute/writers-guide#quotes">Quotes</a></li><li class="sidebar-item__anchor" title="Blockquote"><a href="/contribute/writers-guide#blockquote">Blockquote</a></li><li class="sidebar-item__anchor" title="Tip"><a href="/contribute/writers-guide#tip">Tip</a></li></ul></div><div class="sidebar-item  "><i class="sidebar-item__toggle icon-chevron-right"></i><a class="sidebar-item__title" href="/contribute/writing-a-loader">Writing a Loader</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Setup"><a href="/contribute/writing-a-loader#setup">Setup</a></li><li class="sidebar-item__anchor" title="Simple Usage"><a href="/contribute/writing-a-loader#simple-usage">Simple Usage</a></li><li class="sidebar-item__anchor" title="Complex Usage"><a href="/contribute/writing-a-loader#complex-usage">Complex Usage</a></li><li class="sidebar-item__anchor" title="Guidelines"><a href="/contribute/writing-a-loader#guidelines">Guidelines</a></li><li class="sidebar-item__anchor" title="Simple"><a href="/contribute/writing-a-loader#simple">Simple</a></li><li class="sidebar-item__anchor" title="Chaining"><a href="/contribute/writing-a-loader#chaining">Chaining</a></li><li class="sidebar-item__anchor" title="Modular"><a href="/contribute/writing-a-loader#modular">Modular</a></li><li class="sidebar-item__anchor" title="Stateless"><a href="/contribute/writing-a-loader#stateless">Stateless</a></li><li class="sidebar-item__anchor" title="Loader Utilities"><a href="/contribute/writing-a-loader#loader-utilities">Loader Utilities</a></li><li class="sidebar-item__anchor" title="Loader Dependencies"><a href="/contribute/writing-a-loader#loader-dependencies">Loader Dependencies</a></li><li class="sidebar-item__anchor" title="Module Dependencies"><a href="/contribute/writing-a-loader#module-dependencies">Module Dependencies</a></li><li class="sidebar-item__anchor" title="Common Code"><a href="/contribute/writing-a-loader#common-code">Common Code</a></li><li class="sidebar-item__anchor" title="Absolute Paths"><a href="/contribute/writing-a-loader#absolute-paths">Absolute Paths</a></li><li class="sidebar-item__anchor" title="Peer Dependencies"><a href="/contribute/writing-a-loader#peer-dependencies">Peer Dependencies</a></li><li class="sidebar-item__anchor" title="Testing"><a href="/contribute/writing-a-loader#testing">Testing</a></li></ul></div><div class="sidebar-item sidebar-item--open "><i class="sidebar-item__toggle icon-chevron-right"></i><a class="sidebar-item__title" href="/contribute/writing-a-plugin">Writing a Plugin</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Creating a Plugin"><a href="/contribute/writing-a-plugin#creating-a-plugin">Creating a Plugin</a></li><li class="sidebar-item__anchor" title="Basic plugin architecture"><a href="/contribute/writing-a-plugin#basic-plugin-architecture">Basic plugin architecture</a></li><li class="sidebar-item__anchor" title="Compiler and Compilation"><a href="/contribute/writing-a-plugin#compiler-and-compilation">Compiler and Compilation</a></li><li class="sidebar-item__anchor" title="Accessing Compilation"><a href="/contribute/writing-a-plugin#accessing-compilation">Accessing Compilation</a></li><li class="sidebar-item__anchor" title="Async event hooks"><a href="/contribute/writing-a-plugin#async-event-hooks">Async event hooks</a></li><li class="sidebar-item__anchor" title="Example"><a href="/contribute/writing-a-plugin#example">Example</a></li><li class="sidebar-item__anchor" title="Under the hood"><a href="/contribute/writing-a-plugin#under-the-hood">Under the hood</a></li></ul></div><div class="sidebar-item  "><i class="sidebar-item__toggle icon-chevron-right"></i><a class="sidebar-item__title" href="/contribute/plugin-patterns">Plugin Patterns</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="sort: 5"><a href="/contribute/plugin-patterns#sort-5">sort: 5</a></li><li class="sidebar-item__anchor" title="Exploring assets, chunks, modules, and dependencies"><a href="/contribute/plugin-patterns#exploring-assets-chunks-modules-and-dependencies">Exploring assets, chunks, modules, and dependencies</a></li><li class="sidebar-item__anchor" title="Monitoring the watch graph"><a href="/contribute/plugin-patterns#monitoring-the-watch-graph">Monitoring the watch graph</a></li><li class="sidebar-item__anchor" title="Changed chunks"><a href="/contribute/plugin-patterns#changed-chunks">Changed chunks</a></li></ul></div><div class="sidebar-item  "><i class="sidebar-item__toggle icon-chevron-right"></i><a class="sidebar-item__title" href="/contribute/release-process">Release Process</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Pull Requests"><a href="/contribute/release-process#pull-requests">Pull Requests</a></li><li class="sidebar-item__anchor" title="Releasing"><a href="/contribute/release-process#releasing">Releasing</a></li></ul></div><div class="sidebar-item  "><i class="sidebar-item__toggle icon-chevron-right"></i><a class="sidebar-item__title" href="/contribute/debugging">Debugging</a><ul class="sidebar-item__anchors"><li class="sidebar-item__anchor" title="Stats"><a href="/contribute/debugging#stats">Stats</a></li><li class="sidebar-item__anchor" title="DevTools"><a href="/contribute/debugging#devtools">DevTools</a></li></ul></div></div></nav><section class="page"><div class="page-links"><a class="page-links__link" href="https://github.com/webpack/webpack.js.org/edit/master/src/content/contribute/writing-a-plugin.md">Edit Document<i class="page-links__icon icon-edit"></i></a></div><div class="markdown"><h1>Writing a Plugin</h1><div><p>Plugins expose the full potential of the webpack engine to third-party developers. Using staged build callbacks, developers can introduce their own behaviors into the webpack build process. Building plugins is a bit more advanced than building loaders, because you'll need to understand some of the webpack low-level internals to hook into them. Be prepared to read some source code!</p>
<h2 id="creating-a-plugin">Creating a Plugin<a href="#creating-a-plugin" aria-hidden="true"><span class="icon icon-link"></span></a></h2>
<p>A plugin for <code>webpack</code> consists of a named JavaScript class that:</p>
<ul>
<li>Defines the <code>apply</code> method.</li>
<li>Specifies an <a href="/api/compiler-hooks/">event hook</a> on which to bind itself.</li>
<li>Manipulates the build using the plugin API provided by webpack.</li>
</ul>
<pre><code class="hljs language-javascript"><span class="token keyword">class</span> <span class="token class-name">MyExampleWebpackPlugin</span> <span class="token punctuation">{</span>
  <span class="token comment">// Define the `apply` method</span>
  <span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Specify the event hook to attach to</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compile<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span>
      <span class="token string">'afterCompile'</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span>compilation<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'This is an example plugin!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Here’s the `compilation` object which represents a single build of assets:'</span><span class="token punctuation">,</span> compilation<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Manipulate the build using the plugin API provided by webpack</span>
        compilation<span class="token punctuation">.</span><span class="token function">addModule</span><span class="token punctuation">(</span><span class="token comment">/* ... */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h2 id="basic-plugin-architecture">Basic plugin architecture<a href="#basic-plugin-architecture" aria-hidden="true"><span class="icon icon-link"></span></a></h2>
<p>Plugins are instantiated objects with an <code>apply</code> method on their prototype. This <code>apply</code> method is called once by the webpack compiler while installing the plugin. The <code>apply</code> method is given a reference to the underlying webpack compiler, which grants access to compiler callbacks. A simple plugin is structured as follows:</p>
<pre><code class="hljs language-javascript"><span class="token keyword">class</span> <span class="token class-name">HelloWorldPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>done<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'HelloWorldPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello World!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> HelloWorldPlugin<span class="token punctuation">;</span></code></pre>
<p>Then to use the plugin, include an instance in your webpack config <code>plugins</code> array:</p>
<pre><code class="hljs language-javascript"><span class="token comment">// webpack.config.js</span>
<span class="token keyword">var</span> HelloWorldPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'hello-world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">// ... config settings here ...</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HelloWorldPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>setting<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<h2 id="compiler-and-compilation">Compiler and Compilation<a href="#compiler-and-compilation" aria-hidden="true"><span class="icon icon-link"></span></a></h2>
<p>Among the two most important resources while developing plugins are the <code>compiler</code> and <code>compilation</code> objects. Understanding their roles is an important first step in extending the webpack engine.</p>
<ul>
<li>
<p>The <code>compiler</code> object represents the fully configured webpack environment. This object is built once upon starting webpack, and is configured with all operational settings including options, loaders, and plugins. When applying a plugin to the webpack environment, the plugin will receive a reference to this compiler. Use the compiler to access the main webpack environment.</p>
</li>
<li>
<p>A <code>compilation</code> object represents a single build of versioned assets. While running webpack development middleware, a new compilation will be created each time a file change is detected, thus generating a new set of compiled assets. A compilation surfaces information about the present state of module resources, compiled assets, changed files, and watched dependencies. The compilation also provides many hooks at which a plugin can perform custom actions.</p>
</li>
</ul>
<p>These two components are an integral part of any webpack plugin (especially a <code>compilation</code>), so developers will benefit by familiarizing themselves with these source files:</p>
<ul>
<li><a href="https://github.com/webpack/webpack/blob/master/lib/Compiler.js">Compiler Source</a></li>
<li><a href="https://github.com/webpack/webpack/blob/master/lib/Compilation.js">Compilation Source</a></li>
</ul>
<h2 id="accessing-compilation">Accessing Compilation<a href="#accessing-compilation" aria-hidden="true"><span class="icon icon-link"></span></a></h2>
<p>Compiler exposes a bunch of hooks that provide a reference to each new compilation. Compilations, in their turn, provide additional event hooks for tapping into steps within the build process.</p>
<pre><code class="hljs language-javascript"><span class="token keyword">class</span> <span class="token class-name">HelloCompilationPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Setup callback for accessing a compilation:</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'HelloCompilationPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>compilation<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// Now setup callbacks for accessing compilation steps:</span>
      compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'HelloCompilationPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello compilation!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> HelloCompilationPlugin<span class="token punctuation">;</span></code></pre>
<p>The list of hooks available on the <code>compiler</code>, <code>compilation</code>, and other important objects, see the <a href="/api/plugins/">plugins API</a> docs.</p>
<h2 id="async-event-hooks">Async event hooks<a href="#async-event-hooks" aria-hidden="true"><span class="icon icon-link"></span></a></h2>
<p>Some event hooks are asynchronous. Apart from <code>tap</code>, they also have <code>tapAsync</code> and <code>tapPromise</code> methods. By tapping using these methods, you can do asynchronous actions inside hooks:</p>
<pre><code class="hljs language-javascript"><span class="token keyword">class</span> <span class="token class-name">HelloAsyncPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// tapAsync() is callback-based</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">'HelloAsyncPlugin'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>compilation<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Done with async work...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// tapPromise() is promise-based</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapPromise</span><span class="token punctuation">(</span><span class="token string">'HelloAsyncPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>compilation<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token function">doSomethingAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Done with async work...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Plain old tap() is still here:</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'HelloAsyncPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// No async work here</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Done with sync work...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> HelloAsyncPlugin<span class="token punctuation">;</span></code></pre>
<h2 id="example">Example<a href="#example" aria-hidden="true"><span class="icon icon-link"></span></a></h2>
<p>Once we can latch onto the webpack compiler and each individual compilations, the possibilities become endless for what we can do with the engine itself. We can reformat existing files, create derivative files, or fabricate entirely new assets.</p>
<p>Let's write a simple example plugin that generates a new build file called <code>filelist.md</code>; the contents of which will list all of the asset files in our build. This plugin might look something like this:</p>
<pre><code class="hljs language-javascript"><span class="token keyword">class</span> <span class="token class-name">FileListPlugin</span> <span class="token punctuation">{</span>
  <span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tapAsync</span><span class="token punctuation">(</span><span class="token string">'FileListPlugin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>compilation<span class="token punctuation">,</span> callback<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// Create a header string for the generated file:</span>
      <span class="token keyword">var</span> filelist <span class="token operator">=</span> <span class="token string">'In this build:\n\n'</span><span class="token punctuation">;</span>

      <span class="token comment">// Loop through all compiled assets,</span>
      <span class="token comment">// adding a new line item for each filename.</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> filename <span class="token keyword">in</span> compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        filelist <span class="token operator">+=</span> <span class="token punctuation">(</span><span class="token string">'- '</span><span class="token operator">+</span> filename <span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token comment">// Insert this list into the webpack build as a new file asset:</span>
      compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span><span class="token string">'filelist.md'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> filelist<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> filelist<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> FileListPlugin<span class="token punctuation">;</span></code></pre>
<h2 id="under-the-hood">Under the hood<a href="#under-the-hood" aria-hidden="true"><span class="icon icon-link"></span></a></h2>
<p>Under the hood, webpack uses <a href="https://github.com/webpack/tapable">Tapable</a> to create and run hooks. This is how it looks:</p>
<pre><code class="hljs language-javascript"><span class="token keyword">import</span> <span class="token punctuation">{</span> SyncHook<span class="token punctuation">,</span> AsyncSeriesHook <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'tapable'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">SomeWebpackInternalClass</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token comment">// Create hooks:</span>
      compilation<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">SyncHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      run<span class="token punctuation">:</span> <span class="token keyword">new</span> <span class="token class-name">AsyncSeriesHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">someMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Call a hook:</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Call another hook:</span>
    <span class="token comment">// (This is an async one, so webpack passes a callback into it)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>run<span class="token punctuation">.</span><span class="token function">callAsync</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// The callback is called when all tapped functions finish executing</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>There’re multiple types of hooks which run tapped functions a bit differently. They are described <a href="https://github.com/webpack/tapable#hook-types">in the Tapable docs</a>.</p>
</div><div><hr/><h3>Contributors</h3><div class="contributors"><div class="contributors__list"><a class="contributor" href="https://github.com/tbroadley"><img alt="tbroadley" src="https://github.com/tbroadley.png?size=90"/><span class="contributor__name"> <!-- -->tbroadley</span></a><a class="contributor" href="https://github.com/iamakulov"><img alt="iamakulov" src="https://github.com/iamakulov.png?size=90"/><span class="contributor__name"> <!-- -->iamakulov</span></a><a class="contributor" href="https://github.com/byzyk"><img alt="byzyk" src="https://github.com/byzyk.png?size=90"/><span class="contributor__name"> <!-- -->byzyk</span></a></div></div></div></div></section><div class="gitter"><div class="gitter__button"><i class="gitter__icon icon-gitter"></i></div></div></div><footer class="footer"><div class="container footer__inner"><section class="footer__left"><a class="footer__link" href="/guides/getting-started/">Get Started</a><a class="footer__link" href="/organization/">Organization</a><a class="footer__link" href="/starter-kits/">Starter Kits</a><a class="footer__link" href="/comparison/">Comparison</a></section><section class="footer__middle"><a class="footer__icon" href="/"><img src="/d19378a95ebe6b15d5ddea281138dcf4.svg" alt="webpack icon"/></a></section><section class="footer__right"><a class="footer__link" href="/glossary/">Glossary</a><a class="footer__link" href="/branding/">Branding</a><a href="https://gitter.im/webpack/webpack" target="_blank" rel="noopener" class="footer__link">Gitter</a><a href="https://github.com/webpack/webpack/releases" target="_blank" rel="noopener" class="footer__link">Changelog</a><a class="footer__link footer__license" href="/license"><img alt="Creative Commons License" src="/7052446b5e67df4434f4031afd2f1497.svg"/><img alt="Creative Commons License" src="/7ebb1b3901ce119694f65e04f6347ef5.svg"/></a></section></div></footer></div></div><script src="/vendor.bundle.js"></script><script src="/index.bundle.js"></script></body></html>